#include <iostream>

#include "memory.hpp"
// generated by xxd -i ... 
#include "48rom.h"
#include "diagrom.h"
#include "diagrom2.h"

Memory::Memory() {
    // Initialize all memory to zero
    for (int i = 0; i < 65536; i++) {
        memory[i] = 0;
    }
}

uint8_t Memory::ReadByte(uint16_t address) {
    return memory[address];
}

void Memory::WriteByte(uint16_t address, uint8_t value) {
    if(address < 0x4000) {
        printf("Ignoring attempt to write byte to ROM %x %\n",address,value);
        return;
    }
    memory[address] = value;
}

uint16_t Memory::ReadWord(uint16_t address) {
    // Read word in little-endian format (least significant byte first)
    uint8_t low = memory[address];
    uint8_t high = memory[address + 1];
    return (static_cast<uint16_t>(high) << 8) | static_cast<uint16_t>(low);
}

void Memory::WriteWord(uint16_t address, uint16_t value) {
    if(address < 0x4000) {
        printf("Ignoring attempt to write word to ROM %x %x\n",address,value);
        return;
    }
    // Write word in little-endian format (least significant byte first)
    memory[address] = static_cast<uint8_t>(value & 0xFF);
    memory[address + 1] = static_cast<uint8_t>((value >> 8) & 0xFF);
}

void Memory::Read48(void) {
for (unsigned int i = 0; i < __48_rom_len; i++) {
        memory[i] = __48_rom[i];
    }
}

void Memory::ReadDiag(void) {
for (unsigned int i = 0; i < testrom_bin_len; i++) {
        memory[i] = testrom_bin[i];
    }
}

void Memory::ReadDiag2(void) {
for (unsigned int i = 0; i < DiagROMv_173_len; i++) {
        memory[i] = DiagROMv_173[i];
    }
}